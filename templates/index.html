<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–æ—Å—Ç–æ–≤ –¥–ª—è Telegram</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center mb-4">üöÄ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–æ—Å—Ç–æ–≤ –¥–ª—è Telegram</h1>

        <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
        <div class="card mb-4">
            <div class="card-header">
                <h5>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ API</h5>
            </div>
            <div class="card-body">
                <form id="configForm">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="openai_key" class="form-label">OpenAI API Key</label>
                            <input type="password" class="form-control" id="openai_key" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="stability_key" class="form-label">Stability.ai API Key</label>
                            <input type="password" class="form-control" id="stability_key" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="telegram_api_id" class="form-label">Telegram API ID</label>
                            <input type="text" class="form-control" id="telegram_api_id" required>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="telegram_api_hash" class="form-label">Telegram API Hash</label>
                            <input type="password" class="form-control" id="telegram_api_hash" required>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="telegram_phone" class="form-label">Telegram Phone</label>
                            <input type="tel" class="form-control" id="telegram_phone" placeholder="+7..." required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="telegram_group" class="form-label">Telegram –≥—Ä—É–ø–ø–∞ (username –∏–ª–∏ ID)</label>
                            <input type="text" class="form-control" id="telegram_group" placeholder="@groupname –∏–ª–∏ ID" required>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                </form>
            </div>
        </div>

        <!-- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ -->
        <div class="card mb-4">
            <div class="card-header">
                <h5>‚ú® –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞</h5>
            </div>
            <div class="card-body">
                <form id="generateForm">
                    <div class="mb-3">
                        <label for="topic" class="form-label">–¢–µ–º–∞ –ø–æ—Å—Ç–∞</label>
                        <textarea class="form-control" id="topic" rows="2"
                                placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–º—É –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ—Å—Ç–∞..." required></textarea>
                    </div>
                    <button type="submit" class="btn btn-success" id="generateBtn">
                        üé® –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç
                    </button>
                </form>
            </div>
        </div>

        <!-- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä -->
        <div class="card mb-4" id="previewCard" style="display: none;">
            <div class="card-header">
                <h5>üëÄ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <!-- –¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ -->
                    <div class="col-md-6 mb-3">
                        <h6>üìù –¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞</h6>
                        <div class="border rounded p-3" id="postTextPreview"
                             style="max-height: 400px; overflow-y: auto; white-space: pre-wrap;"></div>
                        <div class="mt-2">
                            <button class="btn btn-warning btn-sm" onclick="regenerateContent('text')">
                                üîÑ –ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç
                            </button>
                            <button class="btn btn-success btn-sm" onclick="approveContent('text')">
                                ‚úÖ –¢–µ–∫—Å—Ç –ø–æ–¥—Ö–æ–¥–∏—Ç
                            </button>
                        </div>
                    </div>

                    <!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
                    <div class="col-md-6 mb-3">
                        <h6>üñºÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º</h6>
                        <div class="text-center">
                            <img id="imagePreview" src="" alt="Preview"
                                 style="max-width: 100%; max-height: 400px; border-radius: 10px;">
                        </div>
                        <div class="mt-2">
                            <p><strong>–ó–∞–≥–æ–ª–æ–≤–æ–∫:</strong> <span id="headlinePreview"></span></p>
                            <button class="btn btn-warning btn-sm" onclick="regenerateContent('image')">
                                üîÑ –ù–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                            </button>
                            <button class="btn btn-warning btn-sm" onclick="regenerateContent('headline')">
                                üîÑ –ù–æ–≤—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
                            </button>
                            <button class="btn btn-success btn-sm" onclick="approveContent('image')">
                                ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–∏—Ç
                            </button>
                            <button class="btn btn-success btn-sm" onclick="approveContent('headline')">
                                ‚úÖ –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ–¥—Ö–æ–¥–∏—Ç
                            </button>
                        </div>
                    </div>
                </div>

                <!-- –°—Ç–∞—Ç—É—Å –æ–¥–æ–±—Ä–µ–Ω–∏—è -->
                <div class="mt-3">
                    <div class="alert alert-info">
                        <strong>–°—Ç–∞—Ç—É—Å –æ–¥–æ–±—Ä–µ–Ω–∏—è:</strong>
                        <ul class="mb-0">
                            <li>–¢–µ–∫—Å—Ç: <span id="textApproval" class="badge bg-secondary">–û–∂–∏–¥–∞–µ—Ç</span></li>
                            <li>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: <span id="imageApproval" class="badge bg-secondary">–û–∂–∏–¥–∞–µ—Ç</span></li>
                            <li>–ó–∞–≥–æ–ª–æ–≤–æ–∫: <span id="headlineApproval" class="badge bg-secondary">–û–∂–∏–¥–∞–µ—Ç</span></li>
                        </ul>
                    </div>

                    <button class="btn btn-primary btn-lg" id="publishBtn" disabled onclick="publishPost()">
                        üì§ –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤ Telegram
                    </button>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∫–æ–¥–∞ Telegram -->
        <div class="modal fade" id="telegramCodeModal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∏–∑ Telegram</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <form id="codeForm">
                            <div class="mb-3">
                                <label for="telegram_code" class="form-label">–ö–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è</label>
                                <input type="text" class="form-control" id="telegram_code" required>
                            </div>
                            <button type="submit" class="btn btn-primary">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
        <div id="messages"></div>
    </div>

    <!-- –ó–∞–≥—Ä—É–∑—á–∏–∫ -->
    <div id="loader" class="d-none">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/script.js"></script>
</body>
</html>